---
# Multimedia codec support via RPM Fusion
# Provides full ffmpeg and additional codecs for gstreamer
modules:
  - type: containerfile
    snippets:
      # Install @multimedia group first (gets -free versions from Fedora)
      - RUN dnf install -y @multimedia --setopt="install_weak_deps=False"
      # Enable RPM Fusion Free and Nonfree repositories
      - RUN dnf install -y https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm
      # Update @multimedia group (replaces -free with full versions from RPM Fusion)
      - RUN dnf update -y @multimedia --setopt="install_weak_deps=False" --exclude=PackageKit-gstreamer-plugin
      # Switch from ffmpeg-free to full ffmpeg
      - RUN dnf swap -y ffmpeg-free ffmpeg --allowerasing
      # Remove RPM Fusion repo files for security (no longer needed after install)
      - RUN rm -f /etc/yum.repos.d/rpmfusion-*.repo
